<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width">
        <title>BulletTime</title>
        <style>
            body{font-family:sans-serif}
            .output {
                display: block;
                border: 1px dotted gray;
                height: 400px;
                width: 100%;
                overflow-y: scroll;
                overflow-x: auto;
                background-color: #eee;
            }
        </style>
    </head>
    <body>
        <h1>BulletTime</h1>
        <p>
            <button type="button" onclick="bullet.play()">Play</button>
            <button type="button" onclick="bullet.pause()">Pause</button>
            <button type="button" onclick="bullet.time()">Log time</button>
        </p>
        <hr>
        <p>
            <input type="number" value="0" class="seek-time">
            <button type="button" onclick="bullet.seek(parseFloat(seekTime.value))">Seek</button>
        </p>
        <hr>
        <p>
            <label><span>Start time:</span><br><input type="number" value="2000" class="start-time"></label>
        </p>
        <p>
            <label><span>Duration:</span><br><input type="number" value="2000" class="duration-time"></label>
        </p>
        <p>
            <button type="button" onclick="bullet.addEvent(parseFloat(startTime.value), parseFloat(durationTime.value), null)">Add event</button>
        </p>

        <h2>Output</h2>
        <p><code class="output"></code></p>
        <p><button type="button" onclick="output.innerHTML = ''">Clear</button></p>

        <h2>Examples</h2>
        <h3>Create a new instance of BulletTime:</h3>
        <code>var bullet = new BulletTime()</code>

        <h3>Add an event to the timeline:</h3>
        <code>var eventId = bullet.addEvent(time, duration, callback)</code>

        <h3>Begin playback:</h3>
        <code>bullet.play()</code>

        <h3>Pause playback:</h3>
        <code>bullet.pause()</code>
        
        <h3>Seek to a time in milliseconds:</h3>
        <code>bullet.seek(time)</code>

        <script src="bullet-time.js"></script>
        <script>
            var bullet = new BulletTime(),
                output = document.getElementsByClassName("output")[0],
                seekTime = document.getElementsByClassName("seek-time")[0],
                startTime = document.getElementsByClassName("start-time")[0],
                durationTime = document.getElementsByClassName("duration-time")[0];
            
            function scrollToBottom () {
                output.scrollTop = output.scrollHeight - output.clientHeight;
            }

            function processOutput (obj) {
                let outputStr = "";
                switch (obj.type) {
                    case "begin":
                        outputStr = "Begin event: " + obj.id 
                        break;
                    case "end":
                        outputStr = "End event: " + obj.id
                        break;
                    case "play":
                        outputStr = "Started playback."
                        break;
                    case "pause":
                        outputStr = "Paused playback."
                        break;
                    case "seek":
                        outputStr = "Seeked to " + obj.time
                        break;
                    case "time":
                        outputStr = "Time: " + obj.time
                        break;
                }
                output.innerHTML += outputStr + "<br>";
                scrollToBottom();
            }

            bullet.registerCallback("begin", (obj) => processOutput(obj));
            bullet.registerCallback("end", (obj) => processOutput(obj));
            bullet.registerCallback("play", (obj) => processOutput(obj));
            bullet.registerCallback("pause", (obj) => processOutput(obj));
            bullet.registerCallback("seek", (obj) => processOutput(obj));
            bullet.registerCallback("time", (obj) => processOutput(obj));
        </script>
    </body>
</html>